!function($){function t(t,e,a,n){for(var r="",s=0,i=a.length;i>s;s++)r+=n(a[s],e);return"<tr>"+r+"</tr>"}function e(t,e){var a=t.attributeWriter(e),n="<td";return(t.hidden||t.textAlign)&&(n+=' style="',t.hidden&&(n+="display: none;"),t.textAlign&&(n+="text-align: "+t.textAlign+";"),n+='"'),n+">"+a+"</td>"}function a(t){return t[this.id]}function n(t,e){return $(t).html()}function r(t,e){var a=this;this.update=function(){var a="",n=e.table.columns,r=e.writers._rowWriter,s=e.writers._cellWriter;t.$element.trigger("dynatable:beforeUpdate",a);for(var i=0,o=e.dataset.records.length;o>i;i++){var d=e.dataset.records[i],u=r(i,d,n,s);a+=u}if(e.features.recordCount&&$("#dynatable-record-count-"+t.element.id).replaceWith(t.recordsCount.create()),e.features.paginate&&($("#dynatable-pagination-links-"+t.element.id).replaceWith(t.paginationLinks.create()),e.features.perPageSelect&&$("#dynatable-per-page-"+t.element.id).val(parseInt(e.dataset.perPage))),e.features.sort&&n){t.sortsHeaders.removeAllArrows();for(var i=0,o=n.length;o>i;i++){var l=n[i],c=x.allMatch(e.dataset.sorts,l.sorts,function(t,e){return e in t}),h=e.dataset.sorts[l.sorts[0]];c&&t.$element.find('[data-dynatable-column="'+l.id+'"]').find(".dynatable-sort-header").each(function(){1==h?t.sortsHeaders.appendArrowUp($(this)):t.sortsHeaders.appendArrowDown($(this))})}}if(e.inputs.queries||e.features.search){var p=e.inputs.queries||$();e.features.search&&(p=p.add("#dynatable-query-search-"+t.element.id)),p.each(function(){var t=$(this),a=e.dataset.queries[t.data("dynatable-query")];t.val(a||"")})}t.$element.find(e.table.bodyRowSelector).remove(),t.$element.append(a),t.$element.trigger("dynatable:afterUpdate",a)}}function s(t,e){var a=this;this.initOnLoad=function(){return t.$element.is("table")},this.init=function(){e.table.columns=[],this.getFromTable()},this.getFromTable=function(){var n=t.$element.find(e.table.headRowSelector).children("th,td");return n.length?void n.each(function(t){a.add($(this),t,!0)}):$.error("Couldn't find any columns headers in '"+e.table.headRowSelector+" th,td'. If your header row is different, specify the selector in the table: headRowSelector option.")},this.add=function(a,n,r,s){var i=e.table.columns,o=a.text(),d=a.data("dynatable-column")||x.normalizeText(o,e.table.defaultColumnIdStyle),u=a.data("dynatable-sorts"),l=u?$.map(u.split(","),function(t){return $.trim(t)}):[d];if(d||(this.generate(a),d=a.data("dynatable-column")),i.splice(n,0,{index:n,label:o,id:d,attributeWriter:e.writers[d]||e.writers._attributeWriter,attributeReader:e.readers[d]||e.readers._attributeReader,sorts:l,hidden:"none"===a.css("display"),textAlign:a.css("text-align")}),a.attr("data-dynatable-column",d).addClass("dynatable-head"),e.table.headRowClass&&a.addClass(e.table.headRowClass),!r){var c=n+1,h=t.$element.find(e.table.headRowSelector).children("th:nth-child("+c+"),td:nth-child("+c+")").first(),p=i.slice(n+1,i.length);if(h.length?h.before(a):t.$element.find(e.table.headRowSelector).append(a),t.sortsHeaders.attachOne(a.get()),p.length)for(var f=0,g=p.length;g>f;f++)p[f].index+=1;s||t.dom.update()}return v},this.remove=function(a){var n=e.table.columns,r=n.length;if("number"==typeof a){var s=n[a];this.removeFromTable(s.id),this.removeFromArray(a)}else for(var i=n.length-1;i>=0;i--){var s=n[i];s.id===a&&(this.removeFromTable(a),this.removeFromArray(i))}t.dom.update()},this.removeFromTable=function(a){t.$element.find(e.table.headRowSelector).children('[data-dynatable-column="'+a+'"]').first().remove()},this.removeFromArray=function(t){var a=e.table.columns,n;a.splice(t,1),n=a.slice(t,a.length);for(var r=0,s=n.length;s>r;r++)n[r].index-=1},this.generate=function(t){var e=void 0===t?$("<th></th>"):t;return this.attachGeneratedAttributes(e)},this.attachGeneratedAttributes=function(a){var n=t.$element.find(e.table.headRowSelector).children("th[data-dynatable-generated]").length;return a.attr("data-dynatable-column","dynatable-generated-"+n).attr("data-dynatable-no-sort","true").attr("data-dynatable-generated",n)}}function i(t,e){var a=this;this.initOnLoad=function(){return!e.dataset.ajax},this.init=function(){null===e.dataset.records&&(e.dataset.records=this.getFromTable(),e.dataset.queryRecordCount||(e.dataset.queryRecordCount=this.count()),e.dataset.totalRecordCount||(e.dataset.totalRecordCount=e.dataset.queryRecordCount)),e.dataset.originalRecords=$.extend(!0,[],e.dataset.records)},this.updateFromJson=function(t){var a;if("_root"===e.params.records?a=t:e.params.records in t&&(a=t[e.params.records]),e.params.record)for(var n=a.length-1,r=0;n>r;r++)a[r]=a[r][e.params.record];e.params.queryRecordCount in t&&(e.dataset.queryRecordCount=t[e.params.queryRecordCount]),e.params.totalRecordCount in t&&(e.dataset.totalRecordCount=t[e.params.totalRecordCount]),e.dataset.records=a},this.sort=function(){var a=[].sort,n=e.dataset.sorts,r=e.dataset.sortsKeys,s=e.dataset.sortTypes,i=function(e,a){var i;if($.isEmptyObject(n))i=t.sorts.functions.originalPlacement(e,a);else for(var o=0,d=r.length;d>o;o++){var u=r[o],l=n[u],c=s[u]||t.sorts.guessType(e,a,u);if(i=t.sorts.functions[c](e,a,u,l),0!==i)break}return i};return a.call(e.dataset.records,i)},this.paginate=function(){var t=this.pageBounds(),a=t[0],n=t[1];e.dataset.records=e.dataset.records.slice(a,n)},this.resetOriginal=function(){e.dataset.records=e.dataset.originalRecords||[]},this.pageBounds=function(){var t=e.dataset.page||1,a=(t-1)*e.dataset.perPage,n=Math.min(a+e.dataset.perPage,e.dataset.queryRecordCount);return[a,n]},this.getFromTable=function(){var a=[],n=e.table.columns,r=t.$element.find(e.table.bodyRowSelector);return r.each(function(r){var s={};s["dynatable-original-index"]=r,$(this).find("th,td").each(function(e){void 0===n[e]&&t.domColumns.add(t.domColumns.generate(),n.length,!1,!0);var a=n[e].attributeReader(this,s),r=n[e].id;"string"==typeof a&&a.match(/\s*\<.+\>/)&&(s["dynatable-sortable-text"]||(s["dynatable-sortable-text"]={}),s["dynatable-sortable-text"][r]=$.trim($("<div></div>").html(a).text())),s[r]=a}),"function"==typeof e.readers._rowReader&&e.readers._rowReader(r,this,s),a.push(s)}),a},this.count=function(){return e.dataset.records.length}}function o(t,e){this.initOnLoad=function(){return e.features.recordCount},this.init=function(){this.attach()},this.create=function(){var a=t.records.count(),n=e.dataset.queryRecordCount,r=e.dataset.totalRecordCount,s=e.inputs.recordCountText,i=e.params.records;if(n>a&&e.features.paginate){var o=t.records.pageBounds();s+="<span class='dynatable-record-bounds'>"+(o[0]+1)+" to "+o[1]+"</span> of "}else a===n&&e.features.paginate&&(s+=a+" of ");return s+=n+" "+i,r>n&&(s+=" (filtered from "+r+" total records)"),$("<span></span>",{id:"dynatable-record-count-"+t.element.id,"class":"dynatable-record-count",html:s})},this.attach=function(){var a=e.inputs.recordCountTarget?$(e.inputs.recordCountTarget):t.$element;a[e.inputs.recordCountPlacement](this.create())}}function d(t,e){this.init=function(){this.attach()},this.create=function(){var a=$("<div></div>",{html:"<span>"+e.inputs.processingText+"</span>",id:"dynatable-processing-"+t.element.id,"class":"dynatable-processing",style:"position: absolute; display: none;"});return a},this.position=function(){var e=$("#dynatable-processing-"+t.element.id),a=e.children("span"),n=a.outerHeight(),r=a.outerWidth(),s=t.$element,i=s.offset(),o=s.outerHeight(),d=s.outerWidth();return e.offset({left:i.left,top:i.top}).width(d).height(o),a.offset({left:i.left+(d-r)/2,top:i.top+(o-n)/2}),e},this.attach=function(){t.$element.before(this.create())},this.show=function(){$("#dynatable-processing-"+t.element.id).show(),this.position()},this.hide=function(){$("#dynatable-processing-"+t.element.id).hide()}}function u(t,e){this.initOnLoad=function(){return e.features.pushState&&history.pushState},this.init=function(){window.onpopstate=function(e){e.state&&e.state.dynatable&&t.state.pop(e)}},this.push=function(a){var n=window.location.search,r,s,i,o,d,u,l,c=!(window.history.state&&window.history.state.dynatable),h=c?"replaceState":"pushState";n&&/^\?/.test(n)&&(n=n.substring(1)),$.extend(r,a),i=x.refreshQueryString(n,a,e),i&&(i="?"+i),o=window.location.hash,s=window.location.pathname,t.$element.trigger("dynatable:push",a),l={dynatable:{dataset:e.dataset}},c||(l.dynatable.scrollTop=$(window).scrollTop()),u=JSON.stringify(l),l.dynatable.dataset.perPageOptions=$.makeArray(l.dynatable.dataset.perPageOptions);try{window.history[h](l,"Dynatable state",s+i+o)}catch(p){l.dynatable.dataset.records=null,window.history[h](l,"Dynatable state",s+i+o)}},this.pop=function(a){var n=a.state.dynatable;e.dataset=n.dataset,n.scrollTop&&$(window).scrollTop(n.scrollTop),n.dataset.records?t.dom.update():t.process(!0)}}function l(t,e){this.initOnLoad=function(){return e.features.sort},this.init=function(){var t=window.location.search.match(new RegExp(e.params.sorts+"[^&=]*=[^&]*","g"));e.dataset.sorts=t?x.deserialize(t)[e.params.sorts]:{},e.dataset.sortsKeys=t?x.keysFromObject(e.dataset.sorts):[]},this.add=function(t,a){var n=e.dataset.sortsKeys,r=$.inArray(t,n);return e.dataset.sorts[t]=a,-1===r&&n.push(t),v},this.remove=function(t){var a=e.dataset.sortsKeys,n=$.inArray(t,a);return delete e.dataset.sorts[t],-1!==n&&a.splice(n,1),v},this.clear=function(){e.dataset.sorts={},e.dataset.sortsKeys.length=0},this.guessType=function(t,e,a){var n={string:"string",number:"number","boolean":"number",object:"number"},r=t[a]?typeof t[a]:typeof e[a],s=n[r]||"number";return s},this.functions={number:function(t,e,a,n){return t[a]===e[a]?0:n>0?t[a]-e[a]:e[a]-t[a]},string:function(t,e,a,n){var r=t["dynatable-sortable-text"]&&t["dynatable-sortable-text"][a]?t["dynatable-sortable-text"][a]:t[a],s=e["dynatable-sortable-text"]&&e["dynatable-sortable-text"][a]?e["dynatable-sortable-text"][a]:e[a],i;return r=r.toLowerCase(),s=s.toLowerCase(),i=r===s?0:n>0?r>s:s>r,i===!1?-1:i-0},originalPlacement:function(t,e){return t["dynatable-original-index"]-e["dynatable-original-index"]}}}function c(t,e){var a=this;this.initOnLoad=function(){return e.features.sort},this.init=function(){this.attach()},this.create=function(n){var r=$(n),s=$("<a></a>",{"class":"dynatable-sort-header",href:"#",html:r.html()}),i=r.data("dynatable-column"),o=x.findObjectInArray(e.table.columns,{id:i});return s.bind("click",function(e){a.toggleSort(e,s,o),t.process(),e.preventDefault()}),this.sortedByColumn(s,o)&&(1==this.sortedByColumnValue(o)?this.appendArrowUp(s):this.appendArrowDown(s)),s},this.removeAll=function(){t.$element.find(e.table.headRowSelector).children("th,td").each(function(){a.removeAllArrows(),a.removeOne(this)})},this.removeOne=function(t){var e=$(t),a=e.find(".dynatable-sort-header");if(a.length){var n=a.html();a.remove(),e.html(e.html()+n)}},this.attach=function(){t.$element.find(e.table.headRowSelector).children("th,td").each(function(){a.attachOne(this)})},this.attachOne=function(t){var e=$(t);e.data("dynatable-no-sort")||e.html(this.create(t))},this.appendArrowUp=function(t){this.removeArrow(t),t.append("<span class='dynatable-arrow'> &#9650;</span>")},this.appendArrowDown=function(t){this.removeArrow(t),t.append("<span class='dynatable-arrow'> &#9660;</span>")},this.removeArrow=function(t){t.find(".dynatable-arrow").remove()},this.removeAllArrows=function(){t.$element.find(".dynatable-arrow").remove()},this.toggleSort=function(a,n,r){var s=this.sortedByColumn(n,r),i=this.sortedByColumnValue(r);if(e.inputs.multisort&&x.anyMatch(a,e.inputs.multisort,function(t,e){return a[e]})||(this.removeAllArrows(),t.sorts.clear()),s)if(1==i){for(var o=0,d=r.sorts.length;d>o;o++)t.sorts.add(r.sorts[o],-1);this.appendArrowDown(n)}else{for(var o=0,d=r.sorts.length;d>o;o++)t.sorts.remove(r.sorts[o]);this.removeArrow(n)}else{for(var o=0,d=r.sorts.length;d>o;o++)t.sorts.add(r.sorts[o],1);this.appendArrowUp(n)}},this.sortedByColumn=function(t,a){return x.allMatch(e.dataset.sorts,a.sorts,function(t,e){return e in t})},this.sortedByColumnValue=function(t){return e.dataset.sorts[t.sorts[0]]}}function h(t,e){var a=this;this.initOnLoad=function(){return e.inputs.queries||e.features.search},this.init=function(){var t=window.location.search.match(new RegExp(e.params.queries+"[^&=]*=[^&]*","g"));e.dataset.queries=t?x.deserialize(t)[e.params.queries]:{},""===e.dataset.queries&&(e.dataset.queries={}),e.inputs.queries&&this.setupInputs()},this.add=function(t,a){return e.features.paginate&&(e.dataset.page=1),e.dataset.queries[t]=a,v},this.remove=function(t){return delete e.dataset.queries[t],v},this.run=function(){for(query in e.dataset.queries)if(e.dataset.queries.hasOwnProperty(query)){var n=e.dataset.queries[query];if(void 0===a.functions[query]){var r=x.findObjectInArray(e.table.columns,{id:query});if(!r){$.error("Query named '"+query+"' called, but not defined in queries.functions");continue}a.functions[query]=function(t,e){return t[query]==e}}e.dataset.records=$.map(e.dataset.records,function(t){return a.functions[query](t,n)?t:null})}e.dataset.queryRecordCount=t.records.count()},this.runSearch=function(a){var n=$.extend({},e.dataset.queries);a?this.add("search",a):this.remove("search"),x.objectsEqual(e.dataset.queries,n)||t.process()},this.setupInputs=function(){e.inputs.queries.each(function(){var n=$(this),r=n.data("dynatable-query-event")||e.inputs.queryEvent,s=n.data("dynatable-query")||n.attr("name")||this.id,i=function(n){var r=$(this).val();return""===r&&(r=void 0),r===e.dataset.queries[s]?!1:(r?a.add(s,r):a.remove(s),t.process(),void n.preventDefault())};n.attr("data-dynatable-query",s).bind(r,i).bind("keypress",function(t){13==t.which&&i.call(this,t)}),e.dataset.queries[s]&&n.val(decodeURIComponent(e.dataset.queries[s]))})},this.functions={search:function(t,e){var a=!1;for(attr in t)if(t.hasOwnProperty(attr)){var n=t[attr];if("string"==typeof n&&-1!==n.toLowerCase().indexOf(e.toLowerCase())){a=!0;break}}else;return a}}}function p(t,e){var a=this;this.initOnLoad=function(){return e.features.search},this.init=function(){this.attach()},this.create=function(){var a=$("<input />",{type:"search",id:"dynatable-query-search-"+t.element.id,"data-dynatable-query":"search",value:e.dataset.queries.search}),n=$("<span></span>",{id:"dynatable-search-"+t.element.id,"class":"dynatable-search",text:"Search: "}).append(a);return a.bind(e.inputs.queryEvent,function(){t.queries.runSearch($(this).val())}).bind("keypress",function(e){13==e.which&&(t.queries.runSearch($(this).val()),e.preventDefault())}),n},this.attach=function(){var a=e.inputs.searchTarget?$(e.inputs.searchTarget):t.$element;a[e.inputs.searchPlacement](this.create())}}function f(t,e){this.initOnLoad=function(){return e.features.paginate},this.init=function(){var t=window.location.search.match(new RegExp(e.params.page+"=([^&]*)"));this.set(t&&e.features.pushState?t[1]:1)},this.set=function(t){e.dataset.page=parseInt(t,10)}}function g(t,e){var a=this;this.initOnLoad=function(){return e.features.paginate},this.init=function(){var t=window.location.search.match(new RegExp(e.params.perPage+"=([^&]*)"));t&&e.features.pushState?this.set(t[1],!0):this.set(e.dataset.perPageDefault,!0),e.features.perPageSelect&&this.attach()},this.create=function(){for(var n=$("<select>",{id:"dynatable-per-page-"+t.element.id,"class":"dynatable-per-page-select"}),r=0,s=e.dataset.perPageOptions.length;s>r;r++){var i=e.dataset.perPageOptions[r],o=e.dataset.perPage==i?'selected="selected"':"";n.append('<option value="'+i+'" '+o+">"+i+"</option>")}return n.bind("change",function(e){a.set($(this).val()),t.process()}),$("<span />",{"class":"dynatable-per-page"}).append("<span class='dynatable-per-page-label'>"+e.inputs.perPageText+"</span>").append(n)},this.attach=function(){var a=e.inputs.perPageTarget?$(e.inputs.perPageTarget):t.$element;a[e.inputs.perPagePlacement](this.create())},this.set=function(a,n){n||t.paginationPage.set(1),e.dataset.perPage=parseInt(a)}}function y(t,e){var a=this;this.initOnLoad=function(){return e.features.paginate},this.init=function(){this.attach()},this.create=function(){var a='<ul id="dynatable-pagination-links-'+t.element.id+'" class="'+e.inputs.paginationClass+'">',n=e.inputs.paginationLinkClass,r=e.inputs.paginationActiveClass,s=e.inputs.paginationDisabledClass,i=Math.ceil(e.dataset.queryRecordCount/e.dataset.perPage),o=e.dataset.page,d=[e.inputs.paginationGap[0],e.dataset.page-e.inputs.paginationGap[1],e.dataset.page+e.inputs.paginationGap[2],i+1-e.inputs.paginationGap[3]];a+="<li><span>Pages: </span></li>";for(var u=1;i>=u;u++)if(!(u>d[0]&&u<d[1]||u>d[2]&&u<d[3])){var l=t.paginationLinks.buildLink(u,u,n,o==u,r),c,h;if(c=$.inArray(u,d),h=d[c+1],c>0&&1!==u&&h&&h>u+1){var p='<li><span class="dynatable-page-break">&hellip;</span></li>';l=2>c?p+l:l+p}if(e.inputs.paginationPrev&&1===u){var f=t.paginationLinks.buildLink(o-1,e.inputs.paginationPrev,n+" "+e.inputs.paginationPrevClass,1===o,s);l=f+l}if(e.inputs.paginationNext&&u===i){var g=t.paginationLinks.buildLink(o+1,e.inputs.paginationNext,n+" "+e.inputs.paginationNextClass,o===i,s);l+=g}a+=l}a+="</ul>";var y="#dynatable-pagination-links-"+t.element.id+" a."+n+":not(."+r+",."+s+")";return $(document).undelegate(y,"click.dynatable"),$(document).delegate(y,"click.dynatable",function(a){$this=$(this),$this.closest(e.inputs.paginationClass).find("."+r).removeClass(r),$this.addClass(r),t.paginationPage.set($this.data("dynatable-page")),t.process(),a.preventDefault()}),a},this.buildLink=function(t,e,a,n,r){var s="<a data-dynatable-page="+t+' class="'+a,i="<li";return n&&(s+=" "+r,i+=' class="'+r+'"'),s+='">'+e+"</a>",i+=">"+s+"</li>"},this.attach=function(){var a=e.inputs.paginationLinkTarget?$(e.inputs.paginationLinkTarget):t.$element;a[e.inputs.paginationLinkPlacement](t.paginationLinks.create())}}var m,b,v,w,C={dom:r,domColumns:s,records:i,recordsCount:o,processingIndicator:d,state:u,sorts:l,sortsHeaders:c,queries:h,inputsSearch:p,paginationPage:f,paginationPerPage:g,paginationLinks:y},x,q,P,R,t,e,a,n;m={features:{paginate:!0,sort:!0,pushState:!0,search:!0,recordCount:!0,perPageSelect:!0},table:{defaultColumnIdStyle:"camelCase",columns:null,headRowSelector:"thead tr",bodyRowSelector:"tbody tr",headRowClass:null},inputs:{queries:null,sorts:null,multisort:["ctrlKey","shiftKey","metaKey"],page:null,queryEvent:"blur change",recordCountTarget:null,recordCountPlacement:"after",paginationLinkTarget:null,paginationLinkPlacement:"after",paginationClass:"dynatable-pagination-links",paginationLinkClass:"dynatable-page-link",paginationPrevClass:"dynatable-page-prev",paginationNextClass:"dynatable-page-next",paginationActiveClass:"dynatable-active-page",paginationDisabledClass:"dynatable-disabled-page",paginationPrev:"Previous",paginationNext:"Next",paginationGap:[1,2,2,1],searchTarget:null,searchPlacement:"before",perPageTarget:null,perPagePlacement:"before",perPageText:"Show: ",recordCountText:"Showing ",processingText:"Processing..."},dataset:{ajax:!1,ajaxUrl:null,ajaxCache:null,ajaxOnLoad:!1,ajaxMethod:"GET",ajaxDataType:"json",totalRecordCount:null,queries:{},queryRecordCount:null,page:null,perPageDefault:10,perPageOptions:[10,20,50,100],sorts:{},sortsKeys:null,sortTypes:{},records:null},writers:{_rowWriter:t,_cellWriter:e,_attributeWriter:a},readers:{_rowReader:null,_attributeReader:n},params:{dynatable:"dynatable",queries:"queries",sorts:"sorts",page:"page",perPage:"perPage",offset:"offset",records:"records",record:null,queryRecordCount:"queryRecordCount",totalRecordCount:"totalRecordCount"}},v={init:function(t,e){return this.settings=b(e),this.element=t,this.$element=$(t),q.call(this),this},process:function(t){P.call(this,t)}},b=function(t){var e=$.extend(!0,{},m,t);return t&&(t.inputs&&(t.inputs.multisort&&(e.inputs.multisort=t.inputs.multisort),t.inputs.paginationGap&&(e.inputs.paginationGap=t.inputs.paginationGap)),t.dataset&&t.dataset.perPageOptions&&(e.dataset.perPageOptions=t.dataset.perPageOptions)),e},q=function(){this.$element.trigger("dynatable:preinit",this);for(O in C)if(C.hasOwnProperty(O)){var t=this[O]=new C[O](this,this.settings);t.initOnLoad()&&t.init()}this.$element.trigger("dynatable:init",this),(!this.settings.dataset.ajax||this.settings.dataset.ajax&&this.settings.dataset.ajaxOnLoad||this.settings.features.paginate)&&this.process()},P=function(t){var e={};if(this.$element.trigger("dynatable:beforeProcess",e),$.isEmptyObject(this.settings.dataset.queries)||(e[this.settings.params.queries]=this.settings.dataset.queries),this.processingIndicator.show(),this.settings.features.sort&&!$.isEmptyObject(this.settings.dataset.sorts)&&(e[this.settings.params.sorts]=this.settings.dataset.sorts),this.settings.features.paginate&&this.settings.dataset.page){var a=this.settings.dataset.page,n=this.settings.dataset.perPage;e[this.settings.params.page]=a,e[this.settings.params.perPage]=n,e[this.settings.params.offset]=(a-1)*n}if(this.settings.dataset.ajaxData&&$.extend(e,this.settings.dataset.ajaxData),this.settings.dataset.ajax){var r=this,s={type:r.settings.dataset.ajaxMethod,dataType:r.settings.dataset.ajaxDataType,data:e,error:function(t,e){},success:function(a){r.$element.trigger("dynatable:ajax:success",a),r.records.updateFromJson(a),r.dom.update(),!t&&r.state.initOnLoad()&&r.state.push(e)},complete:function(){r.processingIndicator.hide()}};this.settings.dataset.ajaxUrl?s.url=this.settings.dataset.ajaxUrl:s.url=x.refreshQueryString(window.location.href,{},this.settings),null!==this.settings.dataset.ajaxCache&&(s.cache=this.settings.dataset.ajaxCache),$.ajax(s)}else this.records.resetOriginal(),this.queries.run(),this.settings.features.sort&&this.records.sort(),this.settings.features.paginate&&this.records.paginate(),this.dom.update(),this.processingIndicator.hide(),!t&&this.state.initOnLoad()&&this.state.push(e);this.$element.trigger("dynatable:afterProcess",e)},w={initOnLoad:function(){return!0},init:function(){}};for(var O in C)if(C.hasOwnProperty(O)){var A=C[O];A.prototype=w}x=v.utility={normalizeText:function(t,e){return t=this.textTransform[e](t)},textTransform:{trimDash:function(t){return t.replace(/^\s+|\s+$/g,"").replace(/\s+/g,"-")},camelCase:function(t){return t=this.trimDash(t),t.replace(/(\-[a-zA-Z])/g,function(t){return t.toUpperCase().replace("-","")}).replace(/([A-Z])([A-Z]+)/g,function(t,e,a){return e+a.toLowerCase()}).replace(/^[A-Z]/,function(t){return t.toLowerCase()})},dashed:function(t){return t=this.trimDash(t),this.lowercase(t)},underscore:function(t){return t=this.trimDash(t),this.lowercase(t.replace(/(-)/g,"_"))},lowercase:function(t){return t.replace(/([A-Z])/g,function(t){return t.toLowerCase()})}},deserialize:function(t){if(!t)return{};"object"==typeof t&&(t=t.join("&"));for(var e={},a=t.split("&"),n=0;n<a.length;n++){var r=a[n].split("="),s=decodeURIComponent(r[0]),i,o;if(r[1]){for(i=decodeURIComponent(r[1].replace(/\+/g," "));o=s.match(/([^&=]+)\[([^&=]+)\]$/);){var d=i;s=o[1],i={},"]["==o[2].substr(o[2].length-2)?i[o[2].substr(0,o[2].length-2)]=[d]:i[o[2]]=d}"undefined"==typeof e[s]?"[]"!=s.substr(s.length-2)?e[s]=i:e[s]=[i]:"string"==typeof e[s]?e[s]=i:"object"==typeof e[s]?e[s]=$.extend({},e[s],i):e[s].push(i)}}return e},refreshQueryString:function(t,e,a){var n=this,r=t.split("?"),s=r.shift(),i;i=this.deserialize(t);for(h in a.params)if(a.params.hasOwnProperty(h)){var o=a.params[h];if(!a.features.sort&&"sorts"==h||!a.features.paginate&&n.anyMatch(h,["page","perPage","offset"],function(t,e){return t==e}))continue;if(("page"===h||"offset"===h)&&1===e.page){i[o]&&delete i[o];continue}if("perPage"===h&&e[o]==a.dataset.perPageDefault){i[o]&&delete i[o];continue}if("queries"==h&&e[o]){var d=a.inputs.queries||[],u=$.makeArray(d.map(function(){return $(this).attr("name")}));a.features.search&&u.push("search");for(var l=0,c=u.length;c>l;l++){var h=u[l];e[o][h]?("undefined"==typeof i[o]&&(i[o]={}),i[o][h]=e[o][h]):delete i[o][h]}continue}e[o]?i[o]=e[o]:delete i[o]}return decodeURI($.param(i))},keysFromObject:function(t){var e=[];for(var a in t)e.push(a);return e},findObjectInArray:function(t,e){for(var a=this,n,r=0,s=t.length;s>r;r++){var i=t[r];if(a.allMatch(i,e,function(t,e,a){return t[e]==a})){n=i;break}}return n},allMatch:function(t,e,a){var n=!0,r=$.isArray(e);return $.each(e,function(e,s){var i=r?a(t,s):a(t,e,s);return i?void 0:n=!1}),n},anyMatch:function(t,e,a){var n=!1,r=$.isArray(e);return $.each(e,function(e,s){var i=r?a(t,s):a(t,e,s);return i?(n=!0,!1):void 0}),n},objectsEqual:function(t,e){for(attr in t)if(t.hasOwnProperty(attr)&&(!e.hasOwnProperty(attr)||t[attr]!==e[attr]))return!1;for(attr in e)if(e.hasOwnProperty(attr)&&!t.hasOwnProperty(attr))return!1;return!0},randomHash:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)}},"function"!=typeof Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),$.dynatableSetup=function(t){m=b(t)},$.dynatable=function(t){$.fn.dynatable=function(e){return this.each(function(){$.data(this,"dynatable")||$.data(this,"dynatable",Object.create(t).init(this,e))})}},$.dynatable(v)}(jQuery);